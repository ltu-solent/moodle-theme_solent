{"version":3,"file":"solent.min.js","sources":["../src/solent.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Theme Solent\n *\n * @module     theme_solent/solent\n * @author     Mark Sharp <mark.sharp@solent.ac.uk>\n * @copyright 2022 Southampton Solent University {@link https://www.solent.ac.uk}\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport {get_string as getString} from 'core/str';\nimport Notification from 'core/notification';\n\n/**\n * Back to top feature.\n */\nexport const totop = () => {\n    let strings = getString('totop', 'theme_solent');\n    let footer = document.querySelector('#page-footer');\n    let page = document.querySelector('html');\n    let button = document.createElement('button');\n    strings.then(function(string) {\n        button.setAttribute('id', 'back-to-top');\n        button.setAttribute('class', 'btn btn-icon bg-secondary icon-no-margin d-print-none');\n        button.setAttribute('aria-label', string);\n        button.innerHTML = '<i aria-hidden=\"true\" class=\"fa fa-chevron-up fa-fw\"></i>';\n        footer.after(button);\n        // This function fades the button in when the page is scrolled down or fades it out\n        // if the user is at the top of the page again.\n        window.addEventListener('scroll', () => {\n            if (page.scrollTop > 220) {\n                button.style.display = 'block';\n            } else {\n                button.style.display = 'none';\n            }\n        });\n\n        // This function scrolls the page to top with a duration of 500ms.\n        button.addEventListener('click', (event) => {\n            event.preventDefault();\n            page.scrollTo({\n                top: 0,\n                left: 0,\n                behavior: 'smooth'\n            });\n        });\n\n        return true;\n    }).fail(Notification.exception);\n};\n\n/**\n * Toggle any form fieldset to be open on load.\n * @param {array} ids List of IDs. Full id including #\n */\nexport const togglefieldsets = (ids) => {\n    ids.forEach(element => {\n        togglefieldset(element);\n    });\n};\n\nconst togglefieldset = (id) => {\n    // Just in case wierd characters manage to get to the query selector,\n    // using a try/catch block to quietly fail.\n    try {\n        id.replace('/[^a-zA-Z0-9#_-]/i', '');\n        let header = document.querySelector('fieldset' + id);\n        if (!header) {\n            return;\n        }\n        header.classList.remove('collapsed');\n        let toggle = header.querySelector('a[data-toggle=\"collapse\"]');\n        toggle.classList.remove('collapsed');\n        toggle.setAttribute('aria-expanded', \"true\");\n        let container = header.querySelector(id + 'container');\n        container.classList.add('show');\n    } catch (ex) {\n        return;\n    }\n};\n"],"names":["strings","footer","document","querySelector","page","button","createElement","then","string","setAttribute","innerHTML","after","window","addEventListener","scrollTop","style","display","event","preventDefault","scrollTo","top","left","behavior","fail","Notification","exception","ids","forEach","element","togglefieldset","id","replace","header","classList","remove","toggle","add","ex"],"mappings":";;;;;;;;+LA6BqB,SACbA,SAAU,mBAAU,QAAS,gBAC7BC,OAASC,SAASC,cAAc,gBAChCC,KAAOF,SAASC,cAAc,QAC9BE,OAASH,SAASI,cAAc,UACpCN,QAAQO,MAAK,SAASC,eAClBH,OAAOI,aAAa,KAAM,eAC1BJ,OAAOI,aAAa,QAAS,yDAC7BJ,OAAOI,aAAa,aAAcD,QAClCH,OAAOK,UAAY,4DACnBT,OAAOU,MAAMN,QAGbO,OAAOC,iBAAiB,UAAU,KAC1BT,KAAKU,UAAY,IACjBT,OAAOU,MAAMC,QAAU,QAEvBX,OAAOU,MAAMC,QAAU,UAK/BX,OAAOQ,iBAAiB,SAAUI,QAC9BA,MAAMC,iBACNd,KAAKe,SAAS,CACVC,IAAK,EACLC,KAAM,EACNC,SAAU,eAIX,KACRC,KAAKC,sBAAaC,qCAOOC,MAC5BA,IAAIC,SAAQC,UACRC,eAAeD,mBAIjBC,eAAkBC,SAIhBA,GAAGC,QAAQ,qBAAsB,QAC7BC,OAAS9B,SAASC,cAAc,WAAa2B,QAC5CE,cAGLA,OAAOC,UAAUC,OAAO,iBACpBC,OAASH,OAAO7B,cAAc,6BAClCgC,OAAOF,UAAUC,OAAO,aACxBC,OAAO1B,aAAa,gBAAiB,QACrBuB,OAAO7B,cAAc2B,GAAK,aAChCG,UAAUG,IAAI,QAC1B,MAAOC"}