{"version":3,"file":"fitvids.min.js","sources":["../src/fitvids.js"],"sourcesContent":["/* jshint ignore:start */\n/* eslint no-invalid-this: 0 */\ndefine(['jquery', 'core/log'], function($) {\n\n    \"use strict\"; // jshint ;_;\n\n    /* jshint browser:true */\n    /* !\n     * FitVids 1.1.\n     *\n     * Copyright 2013, Chris Coyier - http://css-tricks.com + Dave Rupert - http://daverupert.com\n     * Credit to Thierry Koblentz - http://www.alistapart.com/articles/creating-intrinsic-ratios-for-video/\n     * Released under the WTFPL license - http://sam.zoy.org/wtfpl/\n     *\n     * Adapted to AMD for Moodle by Gareth J Barnard.\n     *\n     */\n\n    $.fn.fitVids = function(options) {\n        var settings = {\n            customSelector: null,\n            ignore: [\"object[type='application/pdf']\"],\n            maxwidth: 0,\n            maxheight: 0\n        };\n\n        if (!document.getElementById('fit-vids-style')) {\n            // AppendStyles: https://github.com/toddmotto/fluidvids/blob/master/dist/fluidvids.js\n            var head = document.head || document.getElementsByTagName('head')[0];\n            var css = '.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}' +\n                '.fluid-width-video-wrapper iframe,' +\n                '.fluid-width-video-wrapper object,' +\n                '.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100% !important;height:100% !important;}';\n            var div = document.createElement('div');\n            div.innerHTML = '<p>x</p><style id=\"fit-vids-style\">' + css + '</style>';\n            head.appendChild(div.childNodes[1]);\n        }\n\n        if (options) {\n            $.extend(settings, options);\n        }\n        return this.each(function() {\n            var selectors = [\n                \"iframe[src*='player.vimeo.com']\",\n                \"iframe[src*='youtube.com']\",\n                \"iframe[src*='youtube-nocookie.com']\",\n                \"iframe[src*='kickstarter.com'][src*='video.html']\",\n                \"object\",\n                \"embed\"\n            ];\n\n            if (settings.customSelector) {\n                $(settings.customSelector).each(function() {\n                    if (this != '') {\n                        selectors.push(this);\n                    }\n                });\n            }\n\n            var ignoreList = ['.fitvidsignore'];\n\n            if (settings.ignore) {\n                $(settings.ignore).each(function() {\n                    if (this != '') {\n                        ignoreList.push(this);\n                    }\n                });\n            }\n\n            var $allVideos = $(this).find(selectors.join(','));\n            $allVideos = $allVideos.not(\"object object\"); // SwfObj conflict patch.\n            $allVideos = $allVideos.not(ignoreList.join(',')); // Disable FitVids on these.\n\n            $allVideos.each(function() {\n                var $this = $(this);\n                if ($this.parents(ignoreList.join(',')).length > 0) {\n                    return; // Disable FitVids on this video.\n                }\n\n                var $id = $this.attr('id');\n                if ($id) {\n                    if ($id === 'onlineaudiorecorder') {\n                        return; // Disable FitVids on this 'onlineaudiorecorder' #406 and #536.\n                    }\n                    if ($id.indexOf('mp3') >= 0) {\n                        return; // Disable FitVids on this 'core media mp3' #536.\n                    }\n                }\n\n                if (this.tagName.toLowerCase() === 'embed' && $this.parent('object').length ||\n                    $this.parent('.fluid-width-video-wrapper').length) {\n                        return;\n                    }\n                if ((!$this.css('height') && !$this.css('width')) && (isNaN($this.attr('height')) || isNaN($this.attr('width')))) {\n                    $this.attr('height', 9);\n                    $this.attr('width', 16);\n                }\n                var height = (this.tagName.toLowerCase() === 'object' ||\n                    ($this.attr('height') && !isNaN(parseInt($this.attr('height'), 10))))\n                    ? parseInt($this.attr('height'), 10) : $this.height();\n                var width = !isNaN(parseInt($this.attr('width'), 10)) ? parseInt($this.attr('width'), 10) : $this.width();\n                var aspectRatio = height / width;\n\n                if (!$this.attr('id')) {\n                    var videoID = 'fitvid' + Math.floor(Math.random() * 999999);\n                    $this.attr('id', videoID);\n                }\n\n                $this.wrap('<div class=\"fluid-width-video-wrapper\"></div>').parent('.fluid-width-video-wrapper')\n                    .css('padding-top', (aspectRatio * 100) + \"%\");\n                if (settings.maxwidth > 0 || settings.maxheight > 0) {\n                    var p = $this.parent('.fluid-width-video-wrapper').wrap('<div></div>').parent();\n                    if (settings.maxwidth > 0) {\n                        p.css('max-width', settings.maxwidth + 'px');\n                    }\n                    if (settings.maxheight > 0) {\n                        p.css('max-height', settings.maxheight + 'px');\n                    }\n                }\n                $this.removeAttr('height').removeAttr('width');\n            });\n        });\n    };\n\n    return {\n        init: function(params) {\n            $(document).ready(function($) {\n                $(\".pagelayout-course #page, .pagelayout-incourse #page\").fitVids(params);\n            });\n        }\n    };\n});\n/* jshint ignore:end */\n"],"names":["define","$","fn","fitVids","options","settings","customSelector","ignore","maxwidth","maxheight","document","getElementById","head","getElementsByTagName","div","createElement","innerHTML","appendChild","childNodes","extend","this","each","selectors","push","ignoreList","$allVideos","find","join","not","$this","parents","length","$id","attr","indexOf","tagName","toLowerCase","parent","css","isNaN","aspectRatio","parseInt","height","width","videoID","Math","floor","random","wrap","p","removeAttr","init","params","ready"],"mappings":"AAEAA,8BAAO,CAAC,SAAU,aAAa,SAASC,UAgBpCA,EAAEC,GAAGC,QAAU,SAASC,aAChBC,SAAW,CACXC,eAAgB,KAChBC,OAAQ,CAAC,kCACTC,SAAU,EACVC,UAAW,OAGVC,SAASC,eAAe,kBAAmB,KAExCC,KAAOF,SAASE,MAAQF,SAASG,qBAAqB,QAAQ,GAK9DC,IAAMJ,SAASK,cAAc,OACjCD,IAAIE,UAAY,oSAChBJ,KAAKK,YAAYH,IAAII,WAAW,WAGhCd,SACAH,EAAEkB,OAAOd,SAAUD,SAEhBgB,KAAKC,MAAK,eACTC,UAAY,CACZ,kCACA,6BACA,sCACA,oDACA,SACA,SAGAjB,SAASC,gBACTL,EAAEI,SAASC,gBAAgBe,MAAK,WAChB,IAARD,MACAE,UAAUC,KAAKH,aAKvBI,WAAa,CAAC,kBAEdnB,SAASE,QACTN,EAAEI,SAASE,QAAQc,MAAK,WACR,IAARD,MACAI,WAAWD,KAAKH,aAKxBK,WAAaxB,EAAEmB,MAAMM,KAAKJ,UAAUK,KAAK,OAE7CF,YADAA,WAAaA,WAAWG,IAAI,kBACJA,IAAIJ,WAAWG,KAAK,OAEjCN,MAAK,eACRQ,MAAQ5B,EAAEmB,WACVS,MAAMC,QAAQN,WAAWG,KAAK,MAAMI,OAAS,QAI7CC,IAAMH,MAAMI,KAAK,SACjBD,IAAK,IACO,wBAARA,cAGAA,IAAIE,QAAQ,QAAU,cAKK,UAA/Bd,KAAKe,QAAQC,eAA6BP,MAAMQ,OAAO,UAAUN,QACjEF,MAAMQ,OAAO,8BAA8BN,SAGzCF,MAAMS,IAAI,WAAcT,MAAMS,IAAI,WAAcC,MAAMV,MAAMI,KAAK,aAAcM,MAAMV,MAAMI,KAAK,YAClGJ,MAAMI,KAAK,SAAU,GACrBJ,MAAMI,KAAK,QAAS,SAMpBO,aAJyC,WAA/BpB,KAAKe,QAAQC,eACtBP,MAAMI,KAAK,YAAcM,MAAME,SAASZ,MAAMI,KAAK,UAAW,KAC7DQ,SAASZ,MAAMI,KAAK,UAAW,IAAMJ,MAAMa,WACpCH,MAAME,SAASZ,MAAMI,KAAK,SAAU,KAA2CJ,MAAMc,QAA1CF,SAASZ,MAAMI,KAAK,SAAU,SAGjFJ,MAAMI,KAAK,MAAO,KACfW,QAAU,SAAWC,KAAKC,MAAsB,OAAhBD,KAAKE,UACzClB,MAAMI,KAAK,KAAMW,YAGrBf,MAAMmB,KAAK,iDAAiDX,OAAO,8BAC9DC,IAAI,cAA8B,IAAdE,YAAqB,KAC1CnC,SAASG,SAAW,GAAKH,SAASI,UAAY,EAAG,KAC7CwC,EAAIpB,MAAMQ,OAAO,8BAA8BW,KAAK,eAAeX,SACnEhC,SAASG,SAAW,GACpByC,EAAEX,IAAI,YAAajC,SAASG,SAAW,MAEvCH,SAASI,UAAY,GACrBwC,EAAEX,IAAI,aAAcjC,SAASI,UAAY,MAGjDoB,MAAMqB,WAAW,UAAUA,WAAW,kBAK3C,CACHC,KAAM,SAASC,QACXnD,EAAES,UAAU2C,OAAM,SAASpD,GACvBA,EAAE,wDAAwDE,QAAQiD"}